<h3>Salida por Facturación</h3>
<!-- Fecha y comprobante unicamente -->
<div class="row">
    <div class="form-group mr-3">
        <label for="fecha">Fecha:</label>
        <input type="text" placeholder="Fecha" class="form-control" bsDatepicker name="fecha"
            [bsConfig]="{ dateInputFormat: 'DD/MM/YYYY' }" [(ngModel)]="encabezado.fecha">
    </div>
    <div class="form-group mr-3">
        <label for="cliente">Cliente: </label>
        <select name="infoCliente" id="cliente" class="form-control" [(ngModel)]="encabezado.infoCliente">
            <option *ngFor="let cli of clientes"
                value="{{cli.nombreCliente}}, {{cli.direccion}}, {{cli.telefono}}, {{cli.cuit}}, {{cli.creditoActual}}, {{cli.creditoDisponible}}">
                {{cli.nombreCliente}}</option>
        </select>
    </div>
    <div class="form-group">
        <label for="comprobante">Nº Comprobante/Referencia</label>
        <input type="text" name="comprobante" id="comprobante" [(ngModel)]="encabezado.comprobante"
            class="form-control">
    </div>
</div>
<button (click)="openModal(agregaItem, encabezado, [])">Agrega Item</button>
<div class="row" *ngIf="items">
    <table>
        <thead>
            <th>#Item</th>
            <th>Descripcion</th>
            <th>Precio Unitario</th>
            <th>Cantidad</th>
            <th>Total</th>
        </thead>
        <tbody>
            <tr *ngFor="let item of detalleArray ; let i = index">
                <td> {{i}} </td>
                <td> {{item.nombreProducto}} </td>
                <td> {{item.precioVenta}} </td>
                <td> {{item.cantidadEgreso}} </td>
                <td> {{item.precioTotalLinea}} </td>
            </tr>
        </tbody>
    </table>
</div>
<ng-template #agregaItem>

    <div class="modal-header">
        <h3>Agregar Item de Facturación</h3>
    </div>

    <div class="modal-body">
        <div class="row align-items-center">
            <div class="form-group mr-1 col">
                <label for="producto">Producto:</label>
                <select name="producto" id="producto" class="form-control" name="nombreProducto"
                    (change)="cambioProducto($event)" [(ngModel)]="detalleItem.idProducto">
                    <option *ngFor="let prod of productos"
                        value="{{prod.id}}, {{prod.nombreProducto}}, {{prod.existencia}}, {{prod.precioVenta}} ">
                        {{prod.nombreProducto}}
                    </option>
                </select>
            </div>
            <div class="form-group mr1 col">
                <label for="precioVenta">Precio Unitario</label>
                <input type="number" class="form-control" readonly value="{{precioVentaProvisorio}}" id="precioVenta" name="precioVenta" [(ngModel)]="detalleItem.precioVenta">
            </div>
            <div class="form-group mr1 col">
                <label for="cantidad">Cantidad</label>
                <input type="number" name="cantidad" id="cantidad" class="form-control" value="{{cantidadLinea}}" [(ngModel)]="detalleItem.cantidadEgreso"
                    (input)="calculoSubtotal($event.target.value)">
            </div>
            <div class="form-group mr1 col">
                <label for="precioVentaLinea">Importe</label>
                <input type="number" class="form-control" readonly value="{{precioVentaLinea}}" id="precioVentaLinea" name="precioTotalLinea" [(ngModel)]="detalleItem.precioTotalLinea">
            </div>

        </div>
    </div>
    <div class="modal-footer">
        <button (click)="agregarItem(encabezado, detalleItem)" class="btn btn-primary">
            <fa name="check"></fa> Confirmar
        </button>
        <button (click)="modalRef.hide()">
            <fa name="times"></fa> Cancelar
        </button>
    </div>

</ng-template>